<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡ä»¶ç®¡ç† - æ–‡ä»¶å…±äº«å¹³å°</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <h1>æ–‡ä»¶ç®¡ç†</h1>
        
        <div class="manage-container">
            <div class="info-panel">
                <h3>æ–‡ä»¶ç»„ä¿¡æ¯</h3>
                <div class="info-row">
                    <span class="info-label">å–ä»¶ç ï¼š</span>
                    <span class="info-value code">{{ file_group.pickup_code }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">åˆ›å»ºæ—¶é—´ï¼š</span>
                    <span class="info-value">{{ file_group.created_at[:16].replace('T', ' ') }}</span>
                </div>                <div class="info-row">
                    <span class="info-label">è¿‡æœŸæ—¶é—´ï¼š</span>
                    <span class="info-value">{{ file_group.expiry_date[:19].replace('T', ' ') if file_group.expiry_date else 'æ°¸ä¸è¿‡æœŸ' }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">ä¸‹è½½é™åˆ¶ï¼š</span>
                    <span class="info-value">{{ file_group.max_downloads if file_group.max_downloads else 'ä¸é™åˆ¶' }}</span>
                </div>
                <div class="info-row">
                    <span class="info-label">å·²ä¸‹è½½æ¬¡æ•°ï¼š</span>
                    <span class="info-value">{{ file_group.download_count }}</span>
                </div>
            </div>
            
            <div class="files-panel">
                <h3>æ–‡ä»¶åˆ—è¡¨</h3>
                <div class="file-table-container">
                    <table class="file-table">
                        <thead>
                            <tr>
                                <th>æ–‡ä»¶å</th>
                                <th>å¤§å°</th>
                                <th>ä¸Šä¼ æ—¶é—´</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for file in file_group.files %}
                            <tr>
                                <td>{{ file.name }}</td>
                                <td>{{ (file.size / 1024)|round(1) }} KB</td>
                                <td>{{ file.upload_time[:16].replace('T', ' ') }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="history-panel">
                <h3>ä¸‹è½½è®°å½•</h3>
                <div class="file-table-container">
                    <table class="file-table">
                        <thead>
                            <tr>
                                <th>æ–‡ä»¶å</th>
                                <th>ä¸‹è½½æ—¶é—´</th>
                                <th>IPåœ°å€</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for download in file_group.download_history %}
                            <tr>
                                <td>{{ download.filename }}</td>
                                <td>{{ download.time[:16].replace('T', ' ') }}</td>
                                <td>{{ download.ip }}</td>
                            </tr>
                            {% endfor %}
                            {% if not file_group.download_history %}
                            <tr>
                                <td colspan="3" class="no-data">æš‚æ— ä¸‹è½½è®°å½•</td>
                            </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>            <div class="manage-actions">
                <button id="refresh-page" class="btn primary-btn" data-id="{{ file_group_id }}">
                    <span class="icon">ğŸ”„</span> åˆ·æ–°æ•°æ®
                </button>
                <div class="auto-refresh-container">
                    <input type="checkbox" id="auto-refresh" name="auto-refresh">
                    <label for="auto-refresh">è‡ªåŠ¨åˆ·æ–° (æ¯åˆ†é’Ÿ)</label>
                </div>
                <button id="delete-files" class="btn danger-btn" data-id="{{ file_group_id }}">åˆ é™¤æ­¤æ–‡ä»¶ç»„</button>
                <a href="/" class="btn secondary-btn">è¿”å›ä¸»é¡µ</a>
            </div>
            <div id="refresh-status" class="refresh-status">
                <span class="last-update">ä¸Šæ¬¡æ›´æ–°: <span id="last-update-time">åˆšåˆš</span></span>
                <div id="refresh-spinner" class="refresh-spinner hide"></div>
            </div>
            <div class="refresh-note info-text">
                æ³¨æ„: è‡ªåŠ¨åˆ·æ–°åªåœ¨æ­¤é¡µé¢æ‰“å¼€æ—¶ç”Ÿæ•ˆï¼Œä¸ä¼šå½±å“ä¸‹è½½è¿‡ç¨‹ã€‚
            </div>
        </div>
    </div>
    
    <div id="confirm-modal" class="modal">
        <div class="modal-content">
            <h3>ç¡®è®¤åˆ é™¤</h3>
            <p>æ‚¨ç¡®å®šè¦åˆ é™¤æ­¤æ–‡ä»¶ç»„å—ï¼Ÿåˆ é™¤åå°†æ— æ³•æ¢å¤ã€‚</p>
            <div class="modal-actions">
                <button id="confirm-delete" class="btn danger-btn">ç¡®è®¤åˆ é™¤</button>
                <button id="cancel-delete" class="btn secondary-btn">å–æ¶ˆ</button>
            </div>
        </div>
    </div>
    
    <footer>
        <p>æ–‡ä»¶å…±äº«å¹³å° &copy; 2025</p>
    </footer>
    
    <script src="/static/js/script.js"></script>
</body>
</html>
